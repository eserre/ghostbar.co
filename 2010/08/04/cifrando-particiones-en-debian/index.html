<!DOCTYPE HTML><html><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content=IE-edge><meta name=description content=""><meta name=viewport content="width=device-width, initial-scale=1"><!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]--><link rel="shortcut icon" href=/img/favicon.ico type=image/x-icon><link rel=apple-touch-icon href=/img/favicon-apple-57x57.png><link rel=apple-touch-icon sizes=72x72 href=/img/favicon-apple-72x72.png><link rel=apple-touch-icon sizes=114x114 href=/img/favicon-apple-114x114.png><link href="http://fonts.googleapis.com/css?family=Source+Code+Pro:300|Lato:300,300italic" rel=stylesheet type=text/css><link rel=stylesheet href=/css/main.1c19.css><script src=/js/head-scripts.d41d.js></script><title>Cifrando particiones en Debian &mdash; ghostbar</title></head><body><header id=header class=container><div class=row><div id=logo class=twocol><a href="/"><img src=/img/logo-128x128.b4c1.png></a></div><!-- end of #logo --><div id=title class=sixcol><a href="/"><h1>ghostbar</h1></a><p id=tagline>Random thoughts on technology</p></div><!-- end of #title --><div id=menu class=twocol><ul><li><a href=/archive.html>Archive</a></li><li><a href=https://twitter.com/ghostbar>Twitter</a></li><li><a href=https://github.com/ghostbar>GitHub</a></li><li><a href=/keys>GPG Keys</a></li></ul></div><!-- end of #menu --></div><!-- end of .row --><div class=clearfix></div></header><!-- end of #header.container --><div id=post class=container><div class="row container"><article class="twelvecol post"><header><h1>Cifrando particiones en Debian</h1><div class=date><time datetime=2010-08-04T00:00:00-05:00 pubdate="">August 04, 2010</time></div></header><div class=content><p>Suelo tener una tarjeta SD de 16MB como respaldo de mi clave GPG secreta y pública, así como del certificado de revocación. La única forma de que sea de hecho guardada seguramente es cifrándola y para eso uso <code>dm-crypt</code>. El único problema con <code>dm-crypt</code> es que no cifra <em>on-the-fly</em> sino que necesitas una partición vacía o de lo contrario en el proceso se eliminarán los datos. El proceso es sencillo, aquí explicaré lo que haría con mi tarjeta SD si lo tuviese que hacer de nuevo:</p><ul><li>Instalar <code>cryptsetup</code>:<pre>~$ sudo aptitude install cryptsetup</pre></li><li>Crear una partición nueva en el dispositivo que en este caso llamaremos <code>mmc0p1</code>, para esto recomiendo usar GParted si no se es muy bueno con <code>cfdisk</code>, yo lo hice con éste último porque GParted no formatea en <code>fat12</code> y es el máximo FAT que soporta una partición de <code>16M</code>.</li><li>Ahora, ciframos la partición:<pre>~$ sudo  cryptsetup -v -y -h sha256 luksFormat /dev/mmc0p1</pre>Aquí nos advertirá sobre la re-escritura de la partición y que por ende perderemos todos los datos y escribirán la contraseña que deseen.</li><li>Hecho el paso anterior ahora abriremos la partición para crear una partición virtual dentro de ella:<pre>~$ sudo cryptsetup luksOpen /dev/mmc0p1 sd16M</pre>El <code>sd16M</code> es el nombre que le daremos a la partición virtual, ésta irá a <code>/dev/mapper</code> donde le darán formato.</li><li>Dándole formato a <code>/dev/mapper/sd16M</code>:<pre>~$ mkfs.vfat -F 12 -n "sd16M" /dev/mapper/sd16M</pre></li><li>Ahora cerraremos la partición virtual que hicimos:<pre>~$ sudo cryptsetup luksClose sd16M</pre></li><li>Ya estamos listos básicamente, si tienen configurado para que automonte particiones les quedará más fácil, simplemente remuevan la tarjeta o el dispositivo y vuélvanlo a introducir en la ranura, en esto les saltará una ventana emergente pidiéndoles la clave y listo. Si éste no es el caso entonces tendrán que instalar <code>cryptmount</code> y nada mejor que el manpage para aprender como usarlo, tiene ejemplos completos de como montar particiones protegidas bajo LUKS (el método usado en éste tutorial).</li></ul><p>Estas particiones pueden ser leídas en Windows también usando <a href=http://en.wikipedia.org/wiki/FreeOTFE>FreeOTFE</a>, con tal que Windows soporte el formato de la partición (<code>FAT12</code>, <code>FAT16</code>, <code>FAT32</code>, <code>NTFS</code>)</p></div><footer><small><em>Any comment goes best to my twitter <a href=http://twitter.com/ghostbar>here</a></em>.</small></footer></article></div><!-- end .row --></div><!-- end .container --><script src=/js/script.d16b.js></script><!-- Google Analytics: change UA-XXXXX-X to be your site's ID. --><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
  function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
  e=o.createElement(i);r=o.getElementsByTagName(i)[0];
  e.src='//www.google-analytics.com/analytics.js';
  r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
  ga('create','UA-1022716-2');ga('send','pageview');</script><div class=clearfix></div><footer id=footer class=container><div class=row><div class="twelvecol last"><small>© 2012-2014, Jose Luis Rivas. Built with <a href=http://jekyllrb.com>Jekyll</a> by <a href=http://joseluisrivas.net>Jose Luis Rivas</a>.</small> <small class=pull-right><a href=/feed.xml>RSS</a></small></div><!-- end of .twelvecol --></div><!-- end of .row --></footer><script src=”http://fightforthefuture.github.io/reset-the-net-widget/widget/rtn.js”></script></body></html>